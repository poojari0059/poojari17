#include <stdio.h>

B['(('];
float D['(('];
char a['}']['}'];

A(char q[],int p)
{
	p=&q[p];
}

W(){
     printf("%d",!' ');
}

P(o){
    if(o!=B['[']){
        W();
         P(A(o,')'%'('));
    }
}

L(char a[]){
	B[' ']=A(B[' '],')'%'(');
	if(a[B[' ']])
	 L(a);
}

Y(l){
    if(l!=A(B['`'],B[')'])){
        printf("%s",a[l]);
        if(l!=A(A(B['`'],B[')']),B['  ']) & B[')']!=')'%'('){

            P(!'(');
            if(B[']']!=!'('){
               W();
               B[']']=A(B[']'],B['  ']);
            }
        }
        else if(B[')']==')'%'('){
            P(!'(');
        }
        Y(A(l,')'%'('));
    }

}

R(){
    if(B['(']!=B[';']){
        scanf("%s",a[B['(']]);
        B[' ']=!'(';
        L(a[B['(']]);
       B[B['(']]=B[' '];
        B['(']=A(B['('],')'%'(');
        R();
    }
}

I(){
    if(B['\'']){
        (B['(']>=B[';'])?(
            B['\\']=')'%'(',
            B['\'']=!'('
        ): ( B['{']=A(B['{'],B[B['(']]),
            B[')']=A(B[')'],')'%'('),
            B['(']=A(B['('],')'%'('));

        if(A(B['{'],A(B[')'],B['  ']))>B[','])
            B['\'']=!'(';
        I();
    }
}


O(){

			B['(']=B['`']=A(B['`'],B[')']);

			B[')']=B['\\']=B['{']=!'(';
			B['\'']=')'%'(';
            I();

			if(B['{']==B[','] & B[')']==')'%'('){
				puts(a[B['`']]);
			}
			else{
                if(B['\\']==!'('){
                  B['{']=A(A(B['{'],~B[A(B['('],B['  ']=~!'(')]),')'%'(');
                  B[')']=A(B[')'],B['  ']);
                }

               D[',']= B['}']=A(A(B[','],~B['{']),')'%'(');
                if(B[')']==')'%'('){
                   B[']']=!'(';
                    B['[']=B['}'];
                }
                else{
                   D['.'] =B[']']=A(B[')'],B['  ']);

                    asm ("fdiv":"=t" (D[' ']):"%0" (D[',']),"u" (D['.']));
                    B['[']=D[' '];
                    B[']']=B['}']%B[']'];
                }
                Y(B['`']);

                puts("");
            }
			if(A(B['`'],B[')'])!=B[';'])
			 O();
}

T(){
        scanf("%d%d",&B[';'],&B[',']);
        B['(']=!'(';
        R();
		B['`']=B['(']=B[')']=!'(';
		O();

        B['"']=A(B['"'],')'%'(');
        if(B['"']!=B['.'])
            T();
}

main(){
	scanf("%d",&B['.']);
    T();
    exit(!'(');

}